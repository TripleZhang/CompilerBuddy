<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <title> EDUC</title>
    <link rel="stylesheet" href="../css/course_student.css">
    <link rel="stylesheet" type="text/css" href="../css/reset.css">
    <link rel="stylesheet" type="text/css" href="../css/animate.css">
    <link rel="stylesheet" type="text/css" href="../css/style.css">


</head>


<body>
    <section class="headerwrap">
        <header>
            <div class=" header">
                <div class="top">
                    <div class="wp">
                        <div class="fl">
                            <!-- <p>服务电话：<b>33333333</b></p> -->
                        </div>
                        <!--登录后跳转-->


                        <!-- <a style="color:white" class="fr registerbtn" href="register.html">注册</a> -->
                        <!-- <a style="color:white" class="fr loginbtn" href="login.html">登录</a>  -->

                        <div class="personal">
                            <dl class="user fr">
                                <dd>bobby<img class="down fr" src="../images/top_down.png" /></dd>
                                <dt><img width="20" height="20" src="../media/image/2016/12/default_big_14.png"/></dt>
                            </dl>
                            <div class="userdetail">
                                <dl>
                                    <dt><img width="80" height="80" src="../media/image/2016/12/default_big_14.png"/></dt>
                                    <dd>
                                        <h2>django</h2>
                                        <p>bobby</p>
                                    </dd>
                                </dl>
                                <div class="btn">
                                    <a class="personcenter fl" href="usercenter-info.html">进入个人中心</a>
                                    <a class="fr" href="/logout/">退出</a>
                                </div>
                            </div>
                        </div>


                    </div>
                </div>

                <div class="middle">
                    <div class="wp">
                        <a href="index.html"><img class="fl" src="../images/logo.png" /></a>
                        <div class="searchbox fr">
                            <div class="selectContainer fl">
                                <span class="selectOption" id="jsSelectOption" data-value="course">
                                公开课
                            </span>
                                <ul class="selectMenu" id="jsSelectMenu">
                                    <li data-value="course">公开课</li>
                                    <li data-value="org">课程机构</li>
                                    <li data-value="teacher">授课老师</li>
                                </ul>
                            </div>
                            <input id="search_keywords" class="fl" type="text" value="" placeholder="请输入搜索内容" />
                            <img class="search_btn fr" id="jsSearchBtn" src="../images/search_btn.png" />
                        </div>
                    </div>
                </div>




                <nav>
                    <div class="nav">
                        <div class="wp">
                            <ul>
                                <li class="active"><a href="index.html">首页</a></li>
                                <li>
                                    <a href="course-list.html">
									教程<img class="hot" src="../images/nav_hot.png">
								</a>
                                </li>
                                <li>
                                    <a href="teachers-list.html">帮助</a>
                                </li>
                                <li><a href="org-list.html">联系我们</a></li>
                            </ul>
                        </div>
                    </div>
                </nav>

            </div>
        </header>
    </section>



    <div class='main_page'>
        <div class='tutorial'>
            <h2 id="chapter-3">Chapter 3 语法分析</h2>
            <h3 id="1">1. 开发流程</h3>
            <ul>
                <li>用chapter2中的lex.yy.c替换chapter3中的lex.yy.c</li>
                <li>把lex.yy.c中引入的头文件token.h替换为y.tab.h</li>
                <li>编写tiger语言的BNF范式</li>
                <li>完成tiger.grm程序框架</li>
                <li>使用testcases文件夹中的测试用例测试语法分析器</li>
            </ul>
            <h3 id="2-bnf">2. BNF范式</h3>
            <h4 id="21">2.1 语法描述约定</h4>
            <table>
                <thead>
                    <tr>
                        <th align="center">符号</th>
                        <th align="center">作用</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td align="center">::=</td>
                        <td align="center">非终结符的定义</td>
                    </tr>
                    <tr>
                        <td align="center">abc xyz</td>
                        <td align="center">abc 后接 xyz</td>
                    </tr>
                    <tr>
                        <td align="center">|</td>
                        <td align="center">可选</td>
                    </tr>
                    <tr>
                        <td align="center">[abc]</td>
                        <td align="center">0个或1个abc示例</td>
                    </tr>
                    <tr>
                        <td abc="abc" align="center"></td>
                        <td align="center">Kleene闭包</td>
                    </tr>
                    <tr>
                        <td abc="abc" align="center"></td>
                        <td align="center">正闭包</td>
                    </tr>
                    <tr>
                        <td align="center">（...）</td>
                        <td align="center">组合</td>
                    </tr>
                    <tr>
                        <td align="center">conditionExp</td>
                        <td align="center">非终结符（驼峰写法）</td>
                    </tr>
                    <tr>
                        <td align="center">"+"</td>
                        <td align="center">终结符（用引号标注）</td>
                    </tr>
                </tbody>
            </table>
            <h4 id="22-bnf">2.2 BNF产生式</h4>
            <h5 id="221-tiger">2.2.1 Tiger 程序</h5>
            <ol>
                <li>program ::= exp</li>
            </ol>
            <h5 id="222">2.2.2 声明</h5>
            <ol>
                <li>
                    <p>decs ::= {dec}</p>
                </li>
                <li>
                    <p>dec ::= tydec</p>
                </li>
            </ol>
            <p>​ | vardec</p>
            <p>​ | fundec</p>
            <ol>
                <li>
                    <p>tydec ::= typeKeyword typeId "=" ty</p>
                </li>
                <li>
                    <p>typeKeyword ::= "type"</p>
                </li>
                <li>
                    <p>ty ::= typeId</p>
                </li>
            </ol>
            <p>​ | arrayofKeyword typeId</p>
            <p>​ | "{" tyfields "}"</p>
            <ol>
                <li>
                    <p>arrayofKeyword ::= "array of"</p>
                </li>
                <li>
                    <p>identifier ::= ID</p>
                </li>
                <li>
                    <p>intKeyword ::= "int"</p>
                </li>
                <li>
                    <p>stringKeyword ::= "string"</p>
                </li>
                <li>
                    <p>varKeyword ::= "var"</p>
                </li>
                <li>
                    <p>functionKeyword ::= "function"</p>
                </li>
                <li>
                    <p>tyfields ::= tyfieldsElement {"," tyfieldsElement}</p>
                </li>
                <li>
                    <p>tyfieldsElement ::= identifier ":" typeId</p>
                </li>
                <li>
                    <p>typeId ::= identifier</p>
                    <p>​ | intKeyword</p>
                    <p>​ | stringKeyword</p>
                </li>
                <li>
                    <p>vardec ::= varKeyword identifier ":=" exp</p>
                    <p>​ | varKeyword identifier ":" typeId ":=" exp</p>
                </li>
                <li>
                    <p>fundec ::= functionKeyword identifier "(" tyfields ")" "=" exp</p>
                    <p>​ | functionKeyword identifier "(" tyfields ")" ":" typeId = exp</p>
                </li>
            </ol>
            <h5 id="223">2.2.3 左值</h5>
            <ol>
                <li>lvalue ::= identifier</li>
            </ol>
            <p>​ | lvalue "." identifier</p>
            <p>​ | lvalue "[" exp "]"</p>
            <h5 id="224">2.2.4 表达式</h5>
            <ol>
                <li>exp ::= lvalue | conditionExp | whileExp | breakKeyword | nilKeyword | expSeq | intValue | stringValue | negValue | negId | functionCall | arithmetic | comparition | boolOperation | record | arrayDec | arrayAssign | assignExp | forExp
                    | letExp | typeName</li>
                <li>breakKeyword ::= "break"</li>
                <li>nilKeyword ::= "nil"</li>
                <li>intValue ::= INT</li>
                <li>stringValue ::= String</li>
            </ol>
            <h5 id="225">2.2.5 条件表达式</h5>
            <ol>
                <li>conditionExp ::= ifKeyword exp thenKeyword [elseExp]</li>
                <li>elseExp ::= elseKeyword exp</li>
                <li>ifKeyword ::= "if"</li>
                <li>thenKeyword ::= "then"</li>
                <li>elseKeyword ::= "else"</li>
            </ol>
            <h5 id="226">2.2.6 循环表达式</h5>
            <ol>
                <li>whileExp ::= whileKeyword exp doKeyword exp</li>
                <li>whileKeyword ::= "while"</li>
                <li>doKeyword ::= "do"</li>
                <li>forExp ::= forKeyword identifier ":=" exp toKeyword exp doKeyword exp</li>
                <li>forKeyword ::= "for"</li>
                <li>doKeyword ::= "do"</li>
            </ol>
            <h5 id="227">2.2.7 序列</h5>
            <ol>
                <li>expSeq ::= "(" exp {";" exp}+ ")"</li>
            </ol>
            <h5 id="228">2.2.8 负值</h5>
            <ol>
                <li>negValue ::= "-" intValue</li>
                <li>negId ::= "-" indentifier</li>
            </ol>
            <h5 id="229">2.2.9 函数调用</h5>
            <ol>
                <li>
                    <p>functionCall ::= lvalue "(" argList ")"</p>
                </li>
                <li>
                    <p>argList ::= {argListElement}</p>
                </li>
                <li>argListElement ::= exp {";" exp}</li>
            </ol>
            <h5 id="2210">2.2.10 二元操作</h5>
            <ol>
                <li>arithmetic ::= exp "+" exp</li>
            </ol>
            <p>​ | exp "-" exp</p>
            <p>​ | exp "*" exp</p>
            <p>​ | exp "/" exp</p>
            <ol>
                <li>comparition ::= exp "=" exp</li>
            </ol>
            <p>​ | exp "&lt;&gt;" exp</p>
            <p>​ | exp "&lt;" exp</p>
            <p>​ | exp "&lt;=" exp</p>
            <p>​ | exp "&gt;" exp</p>
            <p>​ | exp "&gt;=" exp</p>
            <ol>
                <li>boolOperation ::= exp "&amp;" exp | exp "|" exp</li>
            </ol>
            <h5 id="2211">2.2.11 记录创建</h5>
            <ol>
                <li>record ::= typeId "{" {recordList} "}"</li>
                <li>recordList ::= recordListElement {"," recordListElement}</li>
                <li>recordListElement ::= identifier "=" exp</li>
            </ol>
            <h5 id="2212">2.2.12 数组创建</h5>
            <ol>
                <li>array ::= typeId "[" exp "]" ofKeyword exp</li>
                <li>ofKeyword ::= "of"</li>
            </ol>
            <h5 id="2213">2.2.13 赋值操作</h5>
            <ol>
                <li>assignExp ::= lvalue ":=" exp | typeId "[" exp "]" ofKeyword exp</li>
            </ol>
            <h5 id="2214-let">2.2.14 let 表达式</h5>
            <ol>
                <li>letExp ::= letKeyword decs inKeyword expSeq endKeyword</li>
                <li>letKeyword ::= "let"</li>
                <li>inKeyword ::= "in"</li>
                <li>endKeyword ::= "end"</li>
            </ol>
            <h3 id="3">3. 冲突</h3>
            <p>语法分析器中存在6个移进/归约冲突，全部由一个原因造成：</p>
            <p>为了消除<code>if - then</code>和<code>if - then - else</code> 的移进/归约冲突，使用改造文法和添加冗余文法的方法解决，改造后的文法中存在新的移进归约冲突。</p>
            <p>改造后的文法：</p>
            <div class="codehilite"><pre><span></span><span class="nl">voidExp</span><span class="p">:</span> <span class="n">matchedExp</span>
       <span class="o">|</span> <span class="n">unmatchedExp</span>
  <span class="p">;</span>

<span class="nl">matchedExp</span><span class="p">:</span> <span class="n">IF</span> <span class="n">lvalueList</span> <span class="n">THEN</span> <span class="n">matchedExp</span> <span class="n">ELSE</span> <span class="n">matchedExp</span>
          <span class="o">|</span> <span class="n">IF</span> <span class="n">comparition</span> <span class="n">THEN</span> <span class="n">matchedExp</span> <span class="n">ELSE</span> <span class="n">matchedExp</span>
          <span class="o">|</span> <span class="n">IF</span> <span class="n">identifier</span> <span class="n">THEN</span> <span class="n">matchedExp</span> <span class="n">ELSE</span> <span class="n">matchedExp</span>
          <span class="o">|</span> <span class="n">IF</span> <span class="n">lvalueArray</span> <span class="n">THEN</span> <span class="n">matchedExp</span> <span class="n">ELSE</span> <span class="n">matchedExp</span>
          <span class="o">|</span> <span class="n">IF</span> <span class="n">INT</span> <span class="n">THEN</span> <span class="n">matchedExp</span> <span class="n">ELSE</span> <span class="n">matchedExp</span>
          <span class="o">|</span> <span class="n">IF</span> <span class="n">expSeq</span> <span class="n">THEN</span> <span class="n">matchedExp</span> <span class="n">ELSE</span> <span class="n">matchedExp</span>
          <span class="o">|</span> <span class="n">functionCall</span>
          <span class="o">|</span> <span class="n">assignExp</span>
          <span class="o">|</span> <span class="n">whileExp</span>
          <span class="o">|</span> <span class="n">BREAK</span>
          <span class="o">|</span> <span class="n">forExp</span>
          <span class="o">|</span> <span class="n">expSeq</span>
          <span class="o">|</span> <span class="n">record</span>
          <span class="o">|</span> <span class="n">NIL</span> 
          <span class="o">|</span> <span class="n">INT</span>
          <span class="o">|</span> <span class="n">STRING</span>
          <span class="o">|</span> <span class="n">identifier</span> 
          <span class="o">|</span> <span class="n">lvalueList</span>
          <span class="o">|</span> <span class="n">lvalueArray</span>
  <span class="p">;</span>

<span class="nl">unmatchedExp</span><span class="p">:</span> <span class="n">IF</span> <span class="n">comparition</span> <span class="n">THEN</span> <span class="n">voidExp</span>
            <span class="o">|</span> <span class="n">IF</span> <span class="n">lvalueList</span> <span class="n">THEN</span> <span class="n">voidExp</span>
            <span class="o">|</span> <span class="n">IF</span> <span class="n">identifier</span> <span class="n">THEN</span> <span class="n">voidExp</span>
            <span class="o">|</span> <span class="n">IF</span> <span class="n">lvalueArray</span> <span class="n">THEN</span> <span class="n">voidExp</span>
            <span class="o">|</span> <span class="n">IF</span> <span class="n">INT</span> <span class="n">THEN</span> <span class="n">voidExp</span>
            <span class="o">|</span> <span class="n">IF</span> <span class="n">expSeq</span> <span class="n">THEN</span> <span class="n">voidExp</span>
            <span class="o">|</span> <span class="n">IF</span> <span class="n">comparition</span> <span class="n">THEN</span> <span class="n">matchedExp</span> <span class="n">ELSE</span> <span class="n">unmatchedExp</span>
            <span class="o">|</span> <span class="n">IF</span> <span class="n">lvalueList</span> <span class="n">THEN</span> <span class="n">matchedExp</span> <span class="n">ELSE</span> <span class="n">unmatchedExp</span>
            <span class="o">|</span> <span class="n">IF</span> <span class="n">identifier</span> <span class="n">THEN</span> <span class="n">matchedExp</span> <span class="n">ELSE</span> <span class="n">unmatchedExp</span>
            <span class="o">|</span> <span class="n">IF</span> <span class="n">lvalueArray</span> <span class="n">THEN</span> <span class="n">matchedExp</span> <span class="n">ELSE</span> <span class="n">unmatchedExp</span>
            <span class="o">|</span> <span class="n">IF</span> <span class="n">INT</span> <span class="n">THEN</span> <span class="n">matchedExp</span> <span class="n">ELSE</span> <span class="n">unmatchedExp</span>
            <span class="o">|</span> <span class="n">IF</span> <span class="n">expSeq</span> <span class="n">THEN</span> <span class="n">matchedExp</span> <span class="n">ELSE</span> <span class="n">unmatchedExp</span>
  <span class="p">;</span>
</pre></div>


            <p>其中，由于<code>Follow(voidExp)</code> 集合中存在<code>ELSE</code> 产生新的冲突：</p>
            <div class="codehilite"><pre><span></span><span class="k">State</span><span class="w"> </span><span class="mi">125</span><span class="w"></span>

<span class="w">   </span><span class="mi">47</span><span class="w"> </span><span class="nl">voidExp</span><span class="p">:</span><span class="w"> </span><span class="n">matchedExp</span><span class="w"> </span><span class="p">.</span><span class="w"></span>
<span class="w">   </span><span class="mi">53</span><span class="w"> </span><span class="nl">matchedExp</span><span class="p">:</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="nc">INT</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="n">matchedExp</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="k">ELSE</span><span class="w"> </span><span class="n">matchedExp</span><span class="w"></span>
<span class="w">   </span><span class="mi">78</span><span class="w"> </span><span class="nl">unmatchedExp</span><span class="p">:</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="nc">INT</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="n">matchedExp</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="k">ELSE</span><span class="w"> </span><span class="n">unmatchedExp</span><span class="w"></span>

<span class="w">    </span><span class="k">ELSE</span><span class="w">  </span><span class="n">shift</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="k">go</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="k">state</span><span class="w"> </span><span class="mi">155</span><span class="w"></span>

<span class="w">    </span><span class="k">ELSE</span><span class="w">      </span><span class="o">[</span><span class="n">reduce using rule 47 (voidExp)</span><span class="o">]</span><span class="w"></span>
<span class="w">    </span><span class="err">$</span><span class="k">default</span><span class="w">  </span><span class="n">reduce</span><span class="w"> </span><span class="k">using</span><span class="w"> </span><span class="k">rule</span><span class="w"> </span><span class="mi">47</span><span class="w"> </span><span class="p">(</span><span class="n">voidExp</span><span class="p">)</span><span class="w"></span>
</pre></div>


            <p>因为Bison在处理移进/归约冲突时，默认选择移进的方法，所以此冲突并不会对语法分析的正确性产生影响。然而，彻底解决该冲突的方法还需要进一步研究。</p>
        </div>


        <div class='file_choice'>
            <button class="collapsible">汇编代码</button>
            <div class="content">
                <ul>
                    <li><button class='filleditor' filecontent='This is uncomplete content to fill'>xxx.c</button></li>
                    <li><button class='filleditor' filecontent='This is uncomplete content to fill'>xxx.c</button></li>
                </ul>
            </div>
            <button class="collapsible">头文件</button>
            <div class="content">
            </div>
            <button class="collapsible"> C文件</button>
            <div class="content">
            </div>
        </div>


        <div class='code_form'>
            <form action="TBD" id="login" method="post">
                <textarea name="" id="code_editor">
#include<iostream>
                            </textarea>

                <div><input type="submit" value="提交" style="display:block;margin:0 auto"></div>
            </form>
        </div>


        <script>
            var coll = document.getElementsByClassName("collapsible");
            var i;

            for (i = 0; i < coll.length; i++) {
                coll[i].addEventListener("click", function() {
                    this.classList.toggle("active");
                    var content = this.nextElementSibling;
                    if (content.style.maxHeight) {
                        content.style.maxHeight = null;
                    } else {
                        content.style.maxHeight = content.scrollHeight + "px";
                    }
                });
            }

            var filledis = document.getElementsByClassName('filleditor')
            var code_editor = document.getElementById('code_editor')
            var i;
            for (i = 0; i < filledis.length; i++) {
                filledis[i].addEventListener("click", function() {
                    code_editor.firstChild.nodeValue = this.getAttribute('filecontent');
                })
            }
        </script>


    </div>




















    <footer>
        <div class="footer">
            <!-- <div class="wp">
                    <ul class="cont">
                        <li class="logo">
                            <a href=""><img src="../images/footlogo.png" /></a>
                        </li>
                        <li class="code"><img src="../images/code.jpg" />
                            <p class="center">扫描关注微信</p>
                        </li>
                        <li class="third"><img class="fl" src="../images/tell.png" />
                            <p class="tell">33333333</p>
                            <p class="time">周一至周日 9:00-18:00</p>
                        </li>
                    </ul>
    
                </div> -->
            <p class="line"></p>
            <div class="wp clear">
                <span class="fl"> 2019 www.projectsedu.com EDUC 保留所有权利</span>
                <span class="fr">copyright  2019 ICP备案证书号：京ICP备xxxxx号-1</span>
            </div>
        </div>
    </footer>




    <section>
        <ul class="sidebar">
            <li class="qq">
                <a target="_blank" href="http://wpa.qq.com/msgrd?v=3&uin=2023525077&site=qq&menu=yes"></a>
            </li>
            <li class="totop"></li>
        </ul>
    </section>





</body>

</html>